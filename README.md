# Программирование, 2 семестр. Занятие 7 #

## Компиляция и запуск ##

Варианты:

1. Запустить `./make.sh` - скрипт для быстрой компиляции и запуска.
2. Прописать вручную `gcc src/llmath.c src/decimal_2 src/decimal_1.c src/main.c; ./a.out`. 

## Задача ##

Ваш компьютер «не знает» арифметики вещественных чисел. Научите его выполнять операции сложения,
вычитания и умножения чисел с плавающей точкой, используя **только**:

- функции для работы с символами и строками,
- операции целочисленной арифметики.

Для этого определите структурный тип данных DECIMAL для представления конечной десятичной дроби, 
и напишите функции:

- `DECIMAL summarize(DECIMAL, DECIMAL)`,
- `DECIMAL subtract(DECIMAL, DECIMAL)`,
- `DECIMAL multiply(DECIMAL, DECIMAL)`,

Которые возвращают значения суммы, разности и произведения значений типа `DECIMAL`.

## Анализ задачи ##

### Определение DECIMAL ###

Тип `DECIMAL` - конечная десятичная дробь. 

- ***Конечная десятичная дробь*** - это *десятичная* дробь, у которой после запятой стоит 
*конечное* число знаков.
- ***Десятичная дробь*** - это разновидность обыкновенной дроби.

По определению: 

- `DECIMAL :: {num * -denum / num∈Z, denum∈N, denum⋮ 10, n∈N}`.

Таким образом десятичную дробь можно представить в виде: 

#### Decimal 1 ####

- `decimal_1 :: {num * 10^(-n) / x∈Z, n∈N}`, где:

    `num` - мантисса,

    `n` - порядок.

Мощность множества значений порядка должна быть не менее чем в 2 раза больше числа знаков,
предоставляемых мантиссой. Так, например, если мантисса может содержать десятизначное число
, то максимальное значение порядка для такой мантиссы должно быть не меньше двадцати.

Если за тип мантиссы принять `signed long long int`, максимальное значение которого 
`9 223 372 036 854 775 807` (19 знаков), то тогда значения для порядка должны быть в 
диапазоне -19 до 19, а значит тип данных для порядка должен содержать как минимум 5 бит. 
На эту роль подойдет `signed char`(7 бит на число и 1 на знак).

Таким образом структура конечной десятичной дроби `decimal_1` имеет 2 поля

- `signed long long int num`
- `signed char n`


#### Decimal 2 ####

Конечную десятичную дробь можно представить в виде: 

    `integer` - Целая часть числа,

    `fractional` - дробная часть числа,

    `n` - порядок, число знаков после запятой.

Примем за тип целой и дробной части `signed long long int`, максимальная длина дробной части
составит 19 знаков после запятой, значит тип данных для порядка `signed char`.

Таким образом структура конечной десятичной дроби `decimal_2` имеет 3 поля:

- `signed long long int integer`
- `signed long long int integer`
- `signed char n`


### summarize ###

Чтобы сложить два числа с плавающей точкой, нужно:

1. Привести числа к одному общему минимальному порядку,
2. Сложить мантиссы.

Приведение числа к необходимому порядку происходит за счет последовательного умножения
мантиссы на 10 и уменьшения мантиссы до необходимого минимального порядка.

### subtract ###

Вычитание работает по аналогии с `summarize`, только мантиссы вычитаются.

### multiply ###

Чтобы умножить два числа с плавающей точкой, нужно:

1. Перемножить их мантиссы,
2. Сложить порядки.

### Нормализация чисел ###

После ввода или в результате вычислений в дробной части могут оказаться незначимые нули 
от которых нужно избавится, постепенно деля мантиссу на 10 и уменьшая порядок, пока тот не
достигнет нуля и пока последнее число мантиссы отлично от него.
